---
title: "6th Blog Post"
subtitle: ""
author: "TEAM 14"
date: "2024-04-15"
draft: false
---

We imported the Google Maps api to create heat maps to analyze where the highest amount of crime is in NYC, and also broke down the distribution of the top three crime categories in NYC.
```{r}
library(dplyr)
library(tidyverse) 
library(ggplot2)
library(dplyr)
library(kableExtra)
library(ggcorrplot)
library(ggmap)
library(leaflet)
library(patchwork)
ds <- read_rds("dataset/load_and_clean_data.rds")
```

```{r include =F}
ds |> dplyr::filter(Latitude > 30, Longitude < -40) -> ds
bbox <- make_bbox(lon = Longitude, lat = Latitude, data = ds, f = 0.1)
a <- get_map(bbox)
ggmap(a)
```

```{r}
```


```{r echo=FALSE, message=FALSE, warning=FALSE}
#2022 ASSAULT 3
ds <- ds |> mutate(ARREST_DATE = mdy(ARREST_DATE))
ds_2022 <- ds |> 
  filter(OFNS_DESC == 'ASSAULT 3 & RELATED OFFENSES',
         ARREST_DATE >= as.Date("2022-01-01") & ARREST_DATE <= as.Date("2022-12-31"))
df_res22 <- ds_2022 |>
  group_by(Longitude, Latitude) |>
  count(name = 'n') |> 
  mutate(G = cut(n, breaks = c(0, 1, 2, 3, 592),
                 labels = c('1', '2', '3', '>3'), 
                 include.lowest = TRUE))
plot_2022as<- ggmap(a) +
  geom_point(data = df_res22, aes(x = Longitude, y = Latitude, color = G),
             alpha = 1, size = 0.5) +
  labs(x = 'Longitude', y = 'Latitude', color = '', title = 'ASSAULT 3 2022') +
  scale_color_manual(values = c('seagreen', 'blue', 'orange', 'tomato')) +
  theme(legend.position = 'top')
```



```{r echo=FALSE, message=FALSE, warning=FALSE}
# 2023 ASSAULT 3
ds_2023 <- ds |> 
  filter(OFNS_DESC == 'ASSAULT 3 & RELATED OFFENSES')
df_res1 <- ds_2023 |>
  group_by(Longitude, Latitude) |>
  count(name = 'n') |> 
  mutate(G = cut(n, breaks = c(0, 1, 2, 3, 592),
                 labels = c('1', '2', '3', '>3'), 
                 include.lowest = TRUE))

plot_2023as <- ggmap(a) +
  geom_point(data = df_res1, aes(x = Longitude, y = Latitude, color = G),
             alpha = 1, size = 0.5) +
  labs(x = 'Longitude', y = 'Latitude', color = '', title = 'ASSAULT 3 2023') +
  scale_color_manual(values = c('seagreen', 'blue', 'orange', 'tomato')) +
  theme(legend.position = 'top')+theme_classic()

```

```{r echo=FALSE, message=FALSE, warning=FALSE}
combined_plot <- plot_2022as + plot_2023as
combined_plot
```

```{r echo =FALSE}
# PETIT LARCENY
ds |> dplyr::filter(OFNS_DESC == 'PETIT LARCENY') |>
  group_by(Longitude, Latitude) |>
  count(name = 'n') |> 
  mutate(G = cut(n, breaks = c(0, 1, 2, 3, 1523),
                 labels = c('1', '2', '3', '>3'), 
                 include.lowest = T)) -> df_res2

ggmap(a) +
  coord_map() +
  geom_point(data = df_res2, aes(x = Longitude, y = Latitude, col = G),
             alpha = 0.5, size = 0.5) +
  scale_x_continuous(limits = range(ds$Longitude)) +
  scale_y_continuous(limits = range(ds$Latitude))  +
  labs(x = 'Longitude', y = 'Latitude', col = '', title = 'PETIT LARCENY') +
  scale_color_manual(values = c('seagreen', 'blue', 'orange', 'tomato')) +
  theme(legend.position = 'top') 
```

```{r echo=FALSE}
ds |> dplyr::filter(OFNS_DESC == 'FELONY ASSAULT') |>
  group_by(Longitude, Latitude) |>
  count(name = 'n') |> 
  mutate(G = cut(n, breaks = c(0, 1, 2, 3, 511),
                 labels = c('1', '2', '3', '>3'), 
                 include.lowest = T)) -> df_res3

ggmap(a) +
  coord_map() +
  geom_point(data = df_res3, aes(x = Longitude, y = Latitude, col = G),
             alpha = 0.5, size = 0.5) +
  scale_x_continuous(limits = range(ds$Longitude)) +
  scale_y_continuous(limits = range(ds$Latitude))  +
  labs(x = 'Longitude', y = 'Latitude', col = '', title = 'FELONY ASSAULT') +
  scale_color_manual(values = c('seagreen', 'blue', 'orange', 'tomato')) +
  theme(legend.position = 'top') 
```



What is your tentative thesis? Note that a thesis is not a hypothesis or a question. It should in some ways answer a question. (Eg. rather than, "What are the patterns of housing prices in Boston?", something like, "Housing prices in Boston are rising rapidly, especially near T stations and along the water.") The rest of the project should work to support that thesis. That doesn’t mean there won’t be any caveats or uncertainty, but you should try to accurately  provide details that provide evidence for your thesis.

Thesis: