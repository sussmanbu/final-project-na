---
title: "Fourth Blog Post"
subtitle: ""
author: "TEAM 14"
date: "2024-04-08"
draft: false
---

```{r include=F}
library(dplyr)
library(tidyverse) 
library(ggplot2)
library(dplyr)
library(kableExtra)
library(ggcorrplot)
library(ggmap)
library(leaflet)
ds <- read_rds("dataset/load_and_clean_data.rds") 
```

```{r echo =F}


crime_counts_by_day <- ds |>
  group_by(ARREST_DATE) |>
  summarize(Daily_Crime_Count = n(), .groups = "drop")
crime_counts_by_day$ARREST_DATE <- as.Date(crime_counts_by_day$ARREST_DATE)

ggplot(crime_counts_by_day, aes(x = ARREST_DATE, y = Daily_Crime_Count)) +
  geom_line() +  # Use geom_line for time series
  geom_point(size = 0.5, color = "blue") +  # Optional: add points on each date
  labs(title = "Daily Crime Counts",
       x = "Date",
       y = "Number of Crimes") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels if necessary
```

```{r echo =F}

crime_counts_by_day <- ds %>%
  mutate(ARREST_DATE = mdy(ARREST_DATE)) %>%  
  count(ARREST_DATE)  
  
crime_counts_by_month <- crime_counts_by_day %>%
  mutate(Month = floor_date(ARREST_DATE, "month")) %>%
  group_by(Month) %>%
  summarize(Monthly_Crime_Count = sum(n), .groups = "drop")

ggplot(crime_counts_by_month, aes(x = Month, y = Monthly_Crime_Count)) +
  geom_col(fill = "steelblue") +  # Use geom_col for bar charts
  labs(title = "Monthly Crime Counts in 2023",
       x = "Month",
       y = "Crime Incidents") +
  scale_x_date(date_labels = "%b", date_breaks = "1 month") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.5)) 

```


```{r echo =F}
ds|>
ggplot(aes(LAW_CAT_CD)) +
geom_bar(aes(fill = LAW_CAT_CD)) + 
theme_minimal() +
labs(x = 'Types_of_Crimes', y = 'Number of Cases', title = 'Number of Cases by Race') +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r echo =F}
crime_summary <- ds %>%
  group_by(LAW_CAT_CD) %>%
  summarize(Incident_Count = n()) %>%
  arrange(desc(Incident_Count)) %>%
  top_n(10)

# Group by LAW_CAT_CD and AGE_GROUP, and summarize the count
crime_gender_summary <- ds %>%
  filter(LAW_CAT_CD %in% crime_summary$LAW_CAT_CD) %>%
  group_by(LAW_CAT_CD, AGE_GROUP) %>%
  summarize(Incident_Count = n())
# Create a bar plot
ggplot(crime_gender_summary, aes(x = reorder(LAW_CAT_CD,Incident_Count), y=    
                                 Incident_Count, fill = AGE_GROUP)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Total Incidents in General Robbery Categories by Age",
       x = "General Robbery Categories",
       y = "Incident Count",
       fill = "Age") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r echo =F}
crime_summary <- ds %>%
  group_by(OFNS_DESC) %>%
  summarize(Incident_Count = n()) %>%
  arrange(desc(Incident_Count)) %>%
  top_n(10)
# Group by OFNS_DESC and AGE_GROUP, and summarize the count
crime_gender_summary <- ds %>%
  filter(OFNS_DESC %in% crime_summary$OFNS_DESC) %>%
  group_by(OFNS_DESC, AGE_GROUP) %>%
  summarize(Incident_Count = n())
  
# Create a bar plot
ggplot(crime_gender_summary, aes(x = reorder(OFNS_DESC, Incident_Count), y = Incident_Count, fill = AGE_GROUP)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Total Incidents in Top 10 Robbery Categories by Age",
       x = "Robbery Categories",
       y = "Incident Count",
       fill = "Age") +
  theme_minimal() +
  
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```