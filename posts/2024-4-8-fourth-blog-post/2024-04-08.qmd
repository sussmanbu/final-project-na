---
title: "Fourth Blog Post"
subtitle: ""
author: "TEAM 14"
date: "2024-04-08"
draft: false
---

```{r include=F}
library(dplyr)
library(tidyverse) 
library(ggplot2)
library(dplyr)
library(kableExtra)
library(ggcorrplot)
library(ggmap)
library(leaflet)
library(pheatmap)
ds <- read_rds("dataset/load_and_clean_data.rds") 
```

```{r echo=FALSE, message=FALSE, warning= FALSE}
crime_counts_by_day <- ds %>%
  filter(OFNS_DESC=="ASSAULT 3 & RELATED OFFENSES") %>%
  count(ARREST_DATE)

# Aggregate these daily counts to get monthly crime counts
crime_counts_by_month <- crime_counts_by_day %>%
  mutate(Month = floor_date(ARREST_DATE, "month")) %>%
  group_by(Month) %>%
  summarize(Monthly_Crime_Count = sum(n), .groups = "drop")  # Sum daily counts to get monthly

# Plot the monthly crime counts with improved aesthetics
ggplot(crime_counts_by_month, aes(x = Month, y = Monthly_Crime_Count)) +
  geom_col(fill = "steelblue") +  # Bar chart with steelblue color
  labs(title = "Monthly Crime Counts in NYC for 2023",
       x = "Month",
       y = "Number of Crime Incidents") +  # Clear labels for axes and title
  scale_x_date(date_labels = "%b %Y", date_breaks = "1 month") +  # Include year in x-axis labels
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +  # Adjust text alignment for readability
  theme(plot.title = element_text(hjust = 0.5))  # Center the plot title
```











```
