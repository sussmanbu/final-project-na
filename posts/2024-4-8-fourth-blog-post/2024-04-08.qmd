
```{r}
library(dplyr)
library(tidyverse) 
library(ggplot2)
library(dplyr)
library(kableExtra)
library(ggcorrplot)
library(ggmap)
library(leaflet)
ds <- read_rds("dataset/load_and_clean_data.rds") 
ds 
crime_counts_by_day <- ds |>
  group_by(ARREST_DATE) |>
  summarize(Daily_Crime_Count = n(), .groups = "drop")
```
```{r}
crime_counts_by_day$ARREST_DATE <- as.Date(crime_counts_by_day$ARREST_DATE)

ggplot(crime_counts_by_day, aes(x = ARREST_DATE, y = Daily_Crime_Count)) +
  geom_line() +  # Use geom_line for time series
  geom_point(size = 0.5, color = "blue") +  # Optional: add points on each date
  labs(title = "Daily Crime Counts",
       x = "Date",
       y = "Number of Crimes") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels if necessary
```

```{r}
# Making sure ARREST_DATE is a Date object for ggplot to handle correctly
crime_counts_by_day$ARREST_DATE <- as.Date(crime_counts_by_day$ARREST_DATE)

# Create the bar chart
ggplot(crime_counts_by_day, aes(x = ARREST_DATE, y = Daily_Crime_Count)) +
  geom_col() +  # geom_col is used for bar charts when you have the counts already calculated
  labs(title = "Daily Crime Counts", 
       x = "Date", 
       y = "Number of Crimes") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))  # Adjust the angle of x-axis text to avoid overlap
```


```{r}
ds|>
ggplot(aes(LAW_CAT_CD)) +
geom_bar(aes(fill = LAW_CAT_CD)) + 
theme_minimal() +
labs(x = 'Types_of_Crimes', y = 'Number of Cases', title = 'Number of Cases by Race') +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
crime_summary <- ds %>%
  group_by(LAW_CAT_CD) %>%
  summarize(Incident_Count = n()) %>%
  arrange(desc(Incident_Count)) %>%
  top_n(10)

# Group by LAW_CAT_CD and AGE_GROUP, and summarize the count
crime_gender_summary <- ds %>%
  filter(LAW_CAT_CD %in% crime_summary$LAW_CAT_CD) %>%
  group_by(LAW_CAT_CD, AGE_GROUP) %>%
  summarize(Incident_Count = n())
# Create a bar plot
ggplot(crime_gender_summary, aes(x = reorder(LAW_CAT_CD,Incident_Count), y=    
                                 Incident_Count, fill = AGE_GROUP)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Total Incidents in General Robbery Categories by Age",
       x = "General Robbery Categories",
       y = "Incident Count",
       fill = "Age") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
crime_summary <- ds %>%
  group_by(OFNS_DESC) %>%
  summarize(Incident_Count = n()) %>%
  arrange(desc(Incident_Count)) %>%
  top_n(10)
# Group by OFNS_DESC and AGE_GROUP, and summarize the count
crime_gender_summary <- ds %>%
  filter(OFNS_DESC %in% crime_summary$OFNS_DESC) %>%
  group_by(OFNS_DESC, AGE_GROUP) %>%
  summarize(Incident_Count = n())
  
# Create a bar plot
ggplot(crime_gender_summary, aes(x = reorder(OFNS_DESC, Incident_Count), y = Incident_Count, fill = AGE_GROUP)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Total Incidents in Top 10 Robbery Categories by Age",
       x = "Robbery Categories",
       y = "Incident Count",
       fill = "Age") +
  theme_minimal() +
  
  theme(axis.text.x = element_text(angle = 45, hjust = 1))